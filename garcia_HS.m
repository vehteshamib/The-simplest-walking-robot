function zplus = garcia_HS(z)
q1=z(1);  dq1=z(2);  
q2=z(3);  dq2=z(4);  
global m M L g gam

AA =[ L^4*M*dq1*dq2^3*m^2 - (L^2*M^3*g^2)/2 - (L^2*M^3*g^2*cos(2*gam - 2*q1))/2 - (3*L^4*M*dq1^4*m^2)/2 - L^4*M^2*dq1^4*m - (L^4*M*dq2^4*m^2)/4 - L^2*M*g^2*m^2 - L^2*M^2*g^2*m - (L^2*M*g^2*m^2*cos(2*gam - 2*q1 + 2*q2))/2 - (L^2*M*g^2*m^2*cos(2*gam - 2*q1))/2 - L^2*M^2*g^2*m*cos(2*gam - 2*q1) - 2*L^4*M*dq1^4*m^2*cos(2*q1 - q2) - L^4*M^2*dq1^4*m*cos(2*q1 - q2) - (L^4*M*dq1^4*m^2*cos(4*q1 - 2*q2))/2 - (L^4*M^3*dq1^4)/4 + 3*L^4*M*dq1^3*dq2*m^2 + L^4*M^2*dq1^3*dq2*m - (5*L^4*M*dq1^2*dq2^2*m^2)/2 - (L^4*M^2*dq1^2*dq2^2*m)/2 + L^2*M*g^2*m^2*cos(2*gam - 2*q1 + q2) + L^2*M^2*g^2*m*cos(2*gam - 2*q1 + q2) + L^2*M*g^2*m^2*cos(q2) + L^2*M^2*g^2*m*cos(q2) + L^3*M^3*dq1^2*g*cos(gam - q1) - 3*L^4*M*dq1^2*dq2^2*m^2*cos(2*q1 - q2) - (L^4*M*dq1^2*dq2^2*m^2*cos(4*q1 - 2*q2))/2 - L^3*M*dq1^2*g*m^2*cos(gam - 3*q1 + 2*q2) + 2*L^3*M*dq1^2*g*m^2*cos(gam - q1) + 3*L^3*M^2*dq1^2*g*m*cos(gam - q1) + L^3*M*dq2^2*g*m^2*cos(gam - q1) + L^3*M^2*dq2^2*g*m*cos(gam - q1) + L^4*M*dq1*dq2^3*m^2*cos(2*q1 - q2) + 4*L^4*M*dq1^3*dq2*m^2*cos(2*q1 - q2) + L^4*M^2*dq1^3*dq2*m*cos(2*q1 - q2) + L^4*M*dq1^3*dq2*m^2*cos(4*q1 - 2*q2) + L^3*M*dq1^2*g*m^2*cos(gam + q1 - q2) - 2*L^3*M*dq1^2*g*m^2*cos(gam - q1 + q2) + L^3*M^2*dq1^2*g*m*cos(gam + q1 - q2) - L^3*M^2*dq1^2*g*m*cos(gam - q1 + q2) - L^3*M*dq2^2*g*m^2*cos(gam - q1 + q2) + L^3*M*dq1^2*g*m^2*cos(gam - 3*q1 + q2) + L^3*M^2*dq1^2*g*m*cos(gam - 3*q1 + q2) - L^3*M*dq1^2*g*m^2*cos(gam + q1) + L^3*M*dq1*dq2*g*m^2*cos(gam - 3*q1 + 2*q2) - 2*L^3*M*dq1*dq2*g*m^2*cos(gam - q1) - 2*L^3*M^2*dq1*dq2*g*m*cos(gam - q1) - L^3*M*dq1*dq2*g*m^2*cos(gam + q1 - q2) + 2*L^3*M*dq1*dq2*g*m^2*cos(gam - q1 + q2) - L^3*M^2*dq1*dq2*g*m*cos(gam + q1 - q2) - L^3*M*dq1*dq2*g*m^2*cos(gam - 3*q1 + q2) - L^3*M^2*dq1*dq2*g*m*cos(gam - 3*q1 + q2) + L^3*M*dq1*dq2*g*m^2*cos(gam + q1), (L^2*m*(cos(2*q1 - q2) - 1)*(2*g*m*cos(gam - q1 + q2) - 2*g*m*cos(gam - q1) - 2*M*g*cos(gam - q1) + L*M*dq1^2 + 2*L*dq1^2*m + L*dq2^2*m + 2*L*dq1^2*m*cos(2*q1 - q2) - 2*L*dq1*dq2*m - 2*L*dq1*dq2*m*cos(2*q1 - q2))^2)/4
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (L^2*m*(cos(2*q1 - q2) + 1)*(2*g*m*cos(gam - q1 + q2) - 2*g*m*cos(gam - q1) - 2*M*g*cos(gam - q1) + L*M*dq1^2 + 2*L*dq1^2*m + L*dq2^2*m + 2*L*dq1^2*m*cos(2*q1 - q2) - 2*L*dq1*dq2*m - 2*L*dq1*dq2*m*cos(2*q1 - q2))^2)/4,                     -(L^2*m*(2*g*m*cos(gam - q1 + q2) - 2*g*m*cos(gam - q1) - 2*M*g*cos(gam - q1) + L*M*dq1^2 + 2*L*dq1^2*m + L*dq2^2*m + 2*L*dq1^2*m*cos(2*q1 - q2) - 2*L*dq1*dq2*m - 2*L*dq1*dq2*m*cos(2*q1 - q2))^2)/4];
 
 
BB =[-(L^2*dq1*(g*m^2*cos(gam + q1 + q2) - g*m^2*cos(gam + q1) - g*m^2*cos(gam - q1 + 2*q2) - M^2*g*cos(gam - 3*q1) - g*m^2*cos(gam - q1) - g*m^2*cos(gam - 3*q1) - M^2*g*cos(gam + q1) + g*m^2*cos(gam - q1 + q2) + g*m^2*cos(q1 - gam + q2) + g*m^2*cos(gam - 3*q1 + q2) - L*dq1^2*m^2*cos(q2) - L*dq2^2*m^2*cos(q2) - 2*M*g*m*cos(gam + q1) + L*M^2*dq1^2*cos(2*q1) + L*dq1^2*m^2*cos(2*q1) + L*dq2^2*m^2*cos(2*q1) - 2*M*g*m*cos(gam - 3*q1) + M*g*m*cos(gam + q1 + q2) - L*dq1^2*m^2*cos(2*q1 - 2*q2) + L*dq1^2*m^2*cos(4*q1 - q2) + M*g*m*cos(gam - q1 + q2) + M*g*m*cos(q1 - gam + q2) + M*g*m*cos(gam - 3*q1 + q2) + L*dq1*dq2*m^2*cos(q2) + 3*L*M*dq1^2*m*cos(2*q1) + L*M*dq2^2*m*cos(2*q1) - L*dq1*dq2*m^2*cos(2*q1) + L*M*dq1^2*m*cos(4*q1 - q2) + L*dq1*dq2*m^2*cos(2*q1 - 2*q2) - L*dq1*dq2*m^2*cos(4*q1 - q2) - L*M*dq1*dq2*m*cos(q2) - 2*L*M*dq1*dq2*m*cos(2*q1) - L*M*dq1*dq2*m*cos(4*q1 - q2)))/2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (L^2*dq1*m*(g*m*cos(gam - q1) - M*g*cos(gam - q1 + q2) - M*g*cos(q1 - gam + q2) - g*m*cos(gam - q1 + q2) - g*m*cos(q1 - gam + q2) + g*m*cos(gam - q1 + 2*q2) + L*dq1^2*m*cos(2*q1) + L*dq1^2*m*cos(2*q1 - 2*q2) + L*M*dq1^2*cos(q2) + 2*L*dq1^2*m*cos(q2) + L*dq2^2*m*cos(q2) - L*dq1*dq2*m*cos(2*q1) - L*dq1*dq2*m*cos(2*q1 - 2*q2) - 2*L*dq1*dq2*m*cos(q2)))/2];
dqplus=pinv(AA)*BB;

zplus=[-q1;dqplus(1);-q2;dqplus(2)];
